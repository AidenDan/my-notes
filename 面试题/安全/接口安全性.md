# 接口安全性



## 几个重要客户端传参

1. Token

   可以分为两种，即 API Token（用于访问不需要用户登录的接口，如登录、注册、一些基本数据的获取等。获取接口令牌需要拿appId、timestamp和sign来换，sign=加密(timestamp+key)）和User Token（用于访问需要用户登录之后的接口，如：获取我的基本信息、保存、修改、删除等操作。获取用户令牌需要拿用户名和密码来换）。

   其值一般为UUID，主要用于标识接口掉用者身份，凭证，减少密码传输次数。

   大概场景：用户登录后，服务端生成Token后需要将token作为key，将一些和token关联的信息如user对象作为value保存到服务器缓存/redis 等中，并返回给客户端，当客户端携带者token来访问服务器时，服务器会从缓存/redis中查询token是否存在和其值，不存在则需要重新登录。

   

2. timestamp 时间戳

   ts可以防止url被劫持，或者减轻通过被劫持的url进行DoS攻击。

   服务端可根据客户端传来的时间戳判断接口的时效性。比如时间戳早于服务器时间5分钟的请求，就不再处理了。但请求中的时间戳可能被篡改。

   

3. Sign 签名

   用来防止篡改客户端传参被篡改而引入参数签名，作为接口中的其中一个参数来传递。

   sign的内容通常是客户端参数按照key升序排序后的url的请求，再拼接token、timestamp的加密字符串，同时为了保证sign的可变性，还要再拼接一个nonce（随机数）再对其进行加密（nonce也会传给服务端）。服务到收到请求后，按同样的规则加密比对即可。

   



## 担心和解答

我思考的主要问题存在于签名这块。

- 比如你使用md5加密，黑客也按照同样规则生成sign怎么办

  用户token不泄漏就生成不了，token这块不泄露主要依靠https机制。

  





## 

